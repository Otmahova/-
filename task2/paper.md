# Описание требований к эмулятору приборов учета энергоносителей
Ключевые слова: эмулятор, эмулятор прибора, энергоносители, тепловычислители

## Аннотация

В статье представлен обзор существующих программных решений, эмулирующих работу различных приборов: эмулятор электросчетчиков, эмулятор источника перебойного питания (ИБП), эмулятор экотестера "СОЭКС", эмулятор спектрографа, эмулятор радиометра РКСБ-104.
Были выбраны и описаны критерии для сравнения вышеперечисленных аналогов, на основе которых были сформулированы требования к разрабатываемому программному решению.

## Введение

Иногда для различных производственных целей нужны приборы учета энергоносителей. Один из наиболее популярных тепловычислителей - СПТ 963 [1]. Разработка эмулятора приборов учета энергоносителей даст возможность использовать функциональность приборов, не имея их под рукой, что позволит сэкономить на покупке оборудования. Например, с помощью эмулятора можно тестировать ПО верхнего уровня, проверять вычисления при подаче
определенных сигналов, моделировать работу в сети для оценки корректности подключения или энергопотребления. Таким образом, можно сделать вывод, что проблема данной статьи - раработка программного решения, способного эмулировать работу физической копии прибора для различных целей.

Целью статьи является определение подхода к разработке эмулятора приборов учета энергоносителей. Объект исследования - эмулятор приборов учета энергоносителей. Предметом исследования является разработка эмулятора для приборов СПТ963 и СПТ944 [2]. 

Для достижения поставленной цели необходимо выполнить следующие задачи:

1. Обзор аналогов эмулятора.
2. Изучить функциональность приборов.
3. Описание способа реализации эмулятора приборов учета энергоносителей.

## Обзор предметной области

### Принцип выбора моделей приборов для дальнейшей разработки эмулятора

Была поставлена задача разработать эмулятор приборов учета энергоносителей. 

Тепловычислители бывают многофункциональной серии и автономной (батарейной) серии. Так, например, прибор СПТ963 относится к многофункциональной серии, так как он рассчитан на применение в системах теплоснабжения, где в качестве теплоносителя выступает вода, конденсат, перегретый и насыщенный пар, а также отличная от воды жидкость. Тепловычислитель СПТ944 относится к другой серии приборов: автономные, или еще их называют батарейные. Данный прибор предназначен для применения в системах, где в качестве теплоносителя выступает вода.

Было решено покрывать функциональность приборов СПТ963 и СПТ944, как наиболее распространенных тепловычислителей своих серий. Более того, данные приборы работают по разным протоколам и концепциям. Таким образом, выбор данных приборов позволит сделать разрабатываемую программу более универсальной. 

### Принцип отбора аналогов
Для формирования требований и выбора подхода к разработке эмулятора приборов учета энергоносителей были рассмотрены существующие аналоги эмуляторов приборов.

Прямых аналогов эмуляторов приборов учета не так много, поэтому были рассмотрены косвенные аналоги. Поиск производился в поисковой системе Google путем ввода в поисковую строку "Эмулятор прибора" и "Программный эмулятор". 

### Краткое описание аналогов

#### 1. Эмулятор электросчетчиков [3]

Данная программа позволяет эмулировать работу фунцкий конкретных моделей электросчетчиков, а именно:
* Инкотекс-СК «Меркурий 206»;
* Энергомера «СЕ102»;
* Энергомера «СЕ102М»;
* IEK «STAR 104/1».

Все приборы работают по различным протоколам обмена.

#### 2. Эмулятор ИБП [4]

Эмулятор был создан компанией СпецПромДизайн для того, чтобы с его помощью тестировать устройства, выпускаемые компанией. Данная программа эмулирует работу источников бесперебойного питания (ИБП), считывание данных с которых происходит по двум протоколам: Megatec и Voltronic.

#### 3. Эмулятор экотестера "СОЭКС" [5]

Программа была разработана для применения в учебных целях. Прибор, работу которого эмулирует программа, выполняет две функции: проверка уровня нитратов в продуктах и измерение радиационного фона. 

#### 4. Цифровая эмуляция спектрографа [6]

Спектрограф - прибор для промышленных и научных исследований спектров веществ. В базе данных эмулятора хранятся данные о спектральных линиях, имеющихся в спектрах эталонных элементов или веществ. Эмулятор извлекает из базы те данные, которые относятся к требуемым диапазонам исследуемых синтезированных спектров, а далее подготавливает и отображает спектральные карты этих диапазонов на устройство вывода.

#### 5. Эмулятор радиометра РКСБ-104 [7]

Данный эмулятор был разработан для использования в учебных целях, а именно для виртуального проведения лабораторных работ. Прибор РКСБ-104 предназначен для контроля радиационной обстановки: для измерения мощности полевой эквивалентной дозы гамма-излучения, плотности потока бетта-излучения и удельной активности радионуклеида цезий-137 в веществах. Данный эмулятор считывает входные данные из Exel-файла, проверяет необходимые для работы параметры, проводит измерения по определенным правилам и выводит полученное после измерений значение на панель прибора. 

### Критерии сравнения аналогов

#### Графический интерфейс

Наличие графического интерфейса позволит упростить и сделать более удобным использование эмулятора. Так пользователь будет тратить меньше времени.

#### Открытость кода

Доступ к исходному коду программы позволяет другим разработчикам модифицировать код для своих нужд.

#### Поддержка программы

Область разработки ПО стремительно развивается, поэтому программные решения, разработанные несколько лет назад, в настоящий момент могут быть больше не актуальны и более ресурсозатратны. Приборы, эмулируемые данными программами, могут выйти из оборота, а библиотеки и фреймворки, используемые в разработке, могли устареть, поэтому приоритетными становятся новые публикациии, либо публикации, которые обновляются. 

#### Универсальность (Возможность поддержки нескольких протоколов/моделей приборов)

Реализация эмулятора для нескольких протоколов или нескольких моделей приборов позволяет расширить его область применения. 

### Сравнение аналогов

Сравнение аналогов по критериям представлено в табл. 1.

```+``` - Соответствует требованиям критерия.

```-``` - Не соответствует требованиям критерия.

Таблица 1 - Сравнение аналогов по критериям

|Критерий/Аналог|Графический интерфейс|Открытость кода|Поддержка программы|Универсальность|
| :----------------- | :-------------------: | :---------------------: | :-------------: |:---------------------: |
|Эмулятор электросчетчиков|+|+|-|+|
|Эмулятор ИБП|+|+|-|+|
|Эмулятор экотестера "СОЭКС"|+|-|-|+|
|Цифровая эмуляция спектрографа|+|-|-|-|
|Эмулятор радиометра РКСБ-104 |+|-|-|-|

### Выводы по итогам стравнения

По итогам анализа данных, предоставленных в табл.1, можно сделать вывод, что по выделенным критериям лучшими программными эмуляторами приборов являются эмулятор электросчетчиков и эмулятор ИБП, так как они соответствуют трем критериям из четырех. Ни одна из представленных программ не подвергается обновлениям, что говорит о том, что  решения теряют актуальность с каждым годом. Помимо этого, большая часть решений не соответсвует критерию "Открытость кода", что препятствует использованию эмуятора в собственных целях.

## Выбор метода решения

В результате обзора аналогов можно сделать вывод, что существующие программные решения, эмулирующие работу различных приборов, обладают недостатками, такими как: отсутствие обновлений программы (две из пяти программ были разработаны более 10 лет назад), отсутствие исходного кода программы в открытом доступе и невозможность поддержки нескольких протоколов взаимодействия.
Поскольку в ходе обзора решений не было выявлено прямого аналога эмулятора приборов учета энергоносителей, то можно сделать вывод о необходимости разработки данного решения.

На основе сделанных выводов были сформулированы требования к разрабатываемому программному решению:
1. Разрабатываемый эмулятор приборов учета энергоносителей должен иметь пользовательский интерфейс;
2. Решение должно реализовывать взаимодействие по нескольким протоколам (а именно решение должно покрывать по 1 прибору
из батарейной и многофункциональной серии).

Таким образом, разрабатываемое решение - сервер, эмулирующий работу двух приборов, работающих по разным протоколам.
После реализации эмулятора приборов учета энергоносителей готовое программное решение можно будет использовать в производственных целях.

## Описание метода решения

Для разработки программного решения, эмулирующего работу приборов учета энергоносителей, были выбраны следующие техологии: 
* Для разработки серверной части эмулятора выбран язык програмирования Python [8] и модуль Socket [9].
* Для реализации графического интерфейса эмулятора были выбраны язык программирования JavaScript [10] и фреймворк React [11].
* Для разработки эмулятора необходимо эмулировать COM-порт [12], для этого была выбрана программа Virtual COMM Port Driver [13]. 

## Заключение

В ходе исследования была достигнута цель статьи: определен подход к разработке эмулятора приборов учета энергоносителей (СПТ963 и СПТ944).

Были выполнены все задачи исследования: произведен обзор аналогов эмулятора, изучена функциональность приборов, а также описан способ реализации эмулятора приборов учета энергоносителей. 

Прямых аналогов эмулятора приборов учета не было выявлено, по этой причине были рассмотрены косвенные аналоги. Был проведен обзор существующих эмуляторов приборов, по итогам которого был сделан вывод, что ни одно из рассморенных решений не удовлетворяет каждому из выбранных критериев сравнения. 

Был определен список технологий для реализации программы, эмулирующей работу тепловычислителей СПТ963 и СПТ944.

В дальнейшем можно расширить функциональность эмулятора, добавив поддержку других моделей тепловычислителей.

## Источники

[1] Тепловычислитель СПТ963 [Электронный ресурс]. URL: https://xn--80afpics.xn--p1ai/catalog/1/371/ (дата обращения: 27.11.2022).

[2] Тепловычислитель СПТ944 [Электронный ресурс]. URL: logika-consortium.ru/wp-content/uploads/2016/11/Rukovodstvo-po-ekspluatatsii-SPT944-v0405.pdf (дата обращения: 27.11.2022).
[3] Эмулятор электросчетчиков [Электронный ресурс]. URL: https://habr.com/ru/company/spd/blog/576790/ (дата обращения: 19.12.2022).
[4] Эмулятор ИБП [Электронный ресурс]. URL:https://habr.com/ru/company/spd/blog/556588/ (дата обращения: 19.12.2022).
[5] Эмулятор экотестера "СОЭКС" [Электронный ресурс]. URL: https://libeldoc.bsuir.by/bitstream/123456789/12576/2/Kamlach_Programmniy.PDF (дата обращения: 19.12.2022).
[6] Цифровая эмуляция спектрографа [Электронный ресурс]. URL: https://cyberleninka.ru/article/n/tsifrovaya-emulyatsiya-spektrografa (дата обращения: 19.12.2022).
[7] Эмулятор радиометра РКСБ-104 [Электронный ресурс]. URL: https://libeldoc.bsuir.by/bitstream/123456789/27039/1/Programmnyy%20emulyator.PDF (дата обращения: 19.12.2022).
[8] About Python [Электронный ресурс]. URL: https://www.python.org/about/ (дата обращения: 21.12.2022)
[9] Socket [Электронный ресурс]. URL: https://docs.python.org/3/library/socket.html
[10] JavaScript [Электронный ресурс]. URL: https://developer.mozilla.org/en-US/docs/Web/JavaScript (дата обращения: 21.12.2022)
[11] React [Электронный ресурс]. URL: https://reactjs.org/ (дата обращения: 21.12.2022)
[12] COM-порт [Электронный ресурс]. URL: https://us800.ru/com.htm (дата обращения: 21.12.2022)
[13] Virtual COMM Port Driver [Электронный ресурс]. URL: https://www.netburner.com/learn/how-to-create-a-virtual-serial-port/ (дата обращения: 21.12.2022)
